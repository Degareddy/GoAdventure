<button mat-icon-button class="close-button" [mat-dialog-close]="{isAltered:altered}">
  <mat-icon class="close-icon small-icon" color="warn">close</mat-icon>
</button>
<div class="container mx-auto p-0.1 bg-blue-400 shadow rounded">
  <div class="flex justify-between items-center mb-0.1 h-8">
    <div class="flex items-center text-white text-sm">
      <mat-icon class="mr-1">check_box</mat-icon>
      <b>{{this.data.search | titlecase}}</b><b class="ml-2 data text-sm">{{data.tranNo}}</b>
    </div>
    <div class="flex items-end space-x-1 mb-2.5">
      <button mat-raised-button color="accent" class=btnUp (click)="reAllocate()">
        <mat-icon>clear_all</mat-icon>Re-Allocate</button>
    </div>
  </div>
</div>
<div class="mat-card">
  <table mat-table [dataSource]="dataSource" class="mat-table" matSort style="max-height: 300px;">
    <!-- <ng-container matColumnDef="SlNo">
      <th mat-header-cell *matHeaderCellDef>S.No</th>
      <td mat-cell *matCellDef="let element">
        <mat-checkbox [(ngModel)]="element.SlNo" [ngModelOptions]="{standalone: true}"
          (click)="$event.stopPropagation()"></mat-checkbox>
      </td>
    </ng-container> -->
    <ng-container matColumnDef="tranNo">
      <th mat-header-cell *matHeaderCellDef> Tran No </th>
      <td mat-cell *matCellDef="let element"> {{element.tranNo}} </td>
    </ng-container>
    <ng-container matColumnDef="partyName">
      <th mat-header-cell *matHeaderCellDef> Party </th>
      <td mat-cell *matCellDef="let element"> {{element.partyName}} </td>
    </ng-container>

    <ng-container matColumnDef="propName">
      <th mat-header-cell *matHeaderCellDef> Property </th>
      <td mat-cell *matCellDef="let element"> {{element.propName}} </td>
    </ng-container>

    <ng-container matColumnDef="blockName">
      <th mat-header-cell *matHeaderCellDef> Block </th>
      <td mat-cell *matCellDef="let element"> {{element.blockName}} </td>
    </ng-container>

    <ng-container matColumnDef="unitName">
      <th mat-header-cell *matHeaderCellDef> Unit </th>
      <td mat-cell *matCellDef="let element"> {{element.unitName}} </td>
    </ng-container>
    <ng-container matColumnDef="tranDate">
      <th mat-header-cell *matHeaderCellDef> Tran Date </th>
      <td mat-cell *matCellDef="let element"> {{formatDate(element.tranDate)}} </td>
    </ng-container>

    <ng-container matColumnDef="dueDate">
      <th mat-header-cell *matHeaderCellDef> Due Date </th>
      <td mat-cell *matCellDef="let element"> {{formatDate(element.dueDate)}} </td>
    </ng-container>
    <ng-container matColumnDef="actAmount">
      <th mat-header-cell *matHeaderCellDef> Act Amount </th>
      <td mat-cell *matCellDef="let element"> {{element.actAmount | number:'1.2-2'}} </td>
    </ng-container>

    <ng-container matColumnDef="dueAmount">
      <th mat-header-cell *matHeaderCellDef> Due Amount </th>
      <td mat-cell *matCellDef="let element"> {{element.dueAmount| number:'1.2-2'}} </td>
    </ng-container>

    <ng-container matColumnDef="allocatedAmount">
      <th mat-header-cell *matHeaderCellDef> Allocated Amount </th>
      <td mat-cell *matCellDef="let element;let i=index">
        <input matInput [(ngModel)]="element.allocatedAmount" placeholder="Enter Amount" separator appNumberFormat
          [ngModelOptions]="{standalone: true}" (focusout)="amountChanged(element,i)" class="right-align-input"
          [disabled]="element.remarks === 'Allocation is done'"
          style="background-color: rgb(214, 232, 232);width:120px;border: 1px solid;" />
      </td>
    </ng-container>

    <ng-container matColumnDef="balAmount">
      <th mat-header-cell *matHeaderCellDef> Balance Amount </th>
      <td mat-cell *matCellDef="let element"> {{element.balAmount | number:'1.2-2'}} </td>
    </ng-container>

    <ng-container matColumnDef="remarks">
      <th mat-header-cell *matHeaderCellDef>Remarks</th>
      <td mat-cell *matCellDef="let element">
        <mat-icon *ngIf="element.remarks === 'Allocation is done'"
          style="color: green; margin:0">check_circle</mat-icon>
        <mat-icon *ngIf="element.remarks === 'Yet to allocate'" color="warn">hourglass_empty</mat-icon>
        {{element.remarks}}
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns; let i=index;"></tr>
  </table>
</div>

<app-message-box [msg]="retMessage" [classtype]="textMessageClass"></app-message-box>
<div class="btnAlignment">
  <button mat-raised-button color="primary" class="btnUp" (click)="onSubmit()"
    [disabled]="data.mode==='View'"><mat-icon>done</mat-icon>Apply</button>

  <button mat-raised-button color="warn" class="btnUp" type="button" [mat-dialog-close]="{isAltered:altered}">
    <mat-icon>cancel</mat-icon><b>Close</b>
  </button>
</div>
